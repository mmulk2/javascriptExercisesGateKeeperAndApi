"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _isotropicCharacterFold=_interopRequireDefault(require("isotropic-character-fold")),_isotropicError=_interopRequireDefault(require("isotropic-error"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}const _lexicographicOrderRegexp=/^[+-]?\d+(?:\.[+-]?\d+){2,}$/u,_splitString=a=>{const b=[];let c=0;return a.replace(/([+-]?\d+(?:\.[+-]?\d+)*)/gu,(d,e,f)=>(b.push(a.substring(c,f)),b.push(d),c=f+d.length,d)),c!==a.length&&b.push(a.substring(c)),b};var _default=({caseSensitive:a=!1,direction:b="asc",ignoreSpecialCharacters:c=!0,prefixPositions:d={}}={})=>{const e=(()=>{switch(b){case"asc":return 1;case"desc":return-1;}throw(0,_isotropicError.default)({details:{direction:b},message:"Invalid direction"})})(),f=-e,g=a=>{switch(a){case"first":return f;case"last":return e;}throw(0,_isotropicError.default)({details:{position:a},message:"Invalid position"})},h=a=>{switch(a){case"first":return e;case"last":return f;}throw(0,_isotropicError.default)({details:{position:a},message:"Invalid position"})},i=(()=>a?c?a=>(0,_isotropicCharacterFold.default)(a):a=>a:c?a=>(0,_isotropicCharacterFold.default)(a).toLowerCase():a=>a.toLowerCase())(),j=Object.keys(d).sort((c,a)=>a.length-c.length);return(c,k)=>{var l=Number.isNaN,m=Math.min;if(!c&&0!==c)return k||0===k?g("last"):0;if(!k&&0!==k)return h("last");c=`${c}`,k=`${k}`;{let a,b;if(j.some(e=>(!a&&c.startsWith(e)&&(a=d[e]),!b&&k.startsWith(e)&&(b=d[e]),a&&b)),a!==b)return a?g(a):h(b)}const n=_splitString(c),o=_splitString(k);for(let a=0,b=m(n.length,o.length);a<b;a+=1){const b=n[a],c=o[a];if(b!==c){{const a=+b,d=+c;if(l(a)){if(l(d)){if(_lexicographicOrderRegexp.test(b)&&_lexicographicOrderRegexp.test(c)){const a=b.split("."),d=c.split(".");for(let b=0,c=m(a.length,d.length);b<c;b+=1){const c=a[b],g=d[b];if(c!==g){{const a=+c,b=+g;if(a>b)return e;if(a<b)return f}return c>g?e:f}}return a.length>d.length?e:f}{const a=i(b),d=i(c);if(a>d)return e;if(a<d)return f}return b>c?e:f}return e}if(l(d))return f;if(a>d)return e;if(a<d)return f}return b>c?e:f}}return n.length>o.length?e:n.length<o.length?f:0}};exports.default=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2pzL25hdHVyYWwtc29ydC5qcyJdLCJuYW1lcyI6WyJfbGV4aWNvZ3JhcGhpY09yZGVyUmVnZXhwIiwiX3NwbGl0U3RyaW5nIiwic3RyaW5nIiwic3BsaXQiLCJsYXN0SW5kZXgiLCJyZXBsYWNlIiwibWF0Y2giLCJudW1iZXJzIiwiaW5kZXgiLCJwdXNoIiwic3Vic3RyaW5nIiwibGVuZ3RoIiwiY2FzZVNlbnNpdGl2ZSIsImRpcmVjdGlvbiIsImlnbm9yZVNwZWNpYWxDaGFyYWN0ZXJzIiwicHJlZml4UG9zaXRpb25zIiwiYUlzR3JlYXRlclRoYW5CIiwiZGV0YWlscyIsIm1lc3NhZ2UiLCJhSXNMZXNzVGhhbkIiLCJhUG9zaXRpb24iLCJwb3NpdGlvbiIsImJQb3NpdGlvbiIsIm5vcm1hbGl6ZVN0cmluZyIsInRvTG93ZXJDYXNlIiwicHJlZml4ZXMiLCJPYmplY3QiLCJrZXlzIiwic29ydCIsImEiLCJiIiwiTnVtYmVyIiwiaXNOYU4iLCJNYXRoIiwibWluIiwiYVByZWZpeFBvc2l0aW9uIiwiYlByZWZpeFBvc2l0aW9uIiwic29tZSIsInByZWZpeCIsInN0YXJ0c1dpdGgiLCJhU3BsaXQiLCJiU3BsaXQiLCJtaW5pbXVtTGVuZ3RoIiwiYUNodW5rIiwiYkNodW5rIiwiYU51bWJlciIsImJOdW1iZXIiLCJ0ZXN0IiwiYUxleGljb2dyYXBoaWNPcmRlciIsImJMZXhpY29ncmFwaGljT3JkZXIiLCJhU3RyaW5nIiwiYlN0cmluZyJdLCJtYXBwaW5ncyI6IjhUQUdBLEtBQU1BLENBQUFBLHlCQUF5QixDQUFHLCtCQUFsQyxDQUNJQyxZQUFZLENBQUdDLENBQU0sRUFBSSxDQUNyQixLQUFNQyxDQUFBQSxDQUFLLENBQUcsRUFBZCxDQUVBLEdBQUlDLENBQUFBLENBQVMsQ0FBRyxDQUFoQixDQWFBLE1BWEFGLENBQUFBLENBQU0sQ0FBQ0csT0FBUCxDQUFlLDZCQUFmLENBQThDLENBQUNDLENBQUQsQ0FBUUMsQ0FBUixDQUFpQkMsQ0FBakIsSUFDMUNM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Q0FDSSxLQUFNK0IsQ0FBQUEsQ0FBTyxDQUFHM0IsQ0FBZSxDQUFDb0IsQ0FBRCxDQUEvQixDQUNJUSxDQUFPLENBQUc1QixDQUFlLENBQUNxQixDQUFELENBRDdCLENBR0EsR0FBSU0sQ0FBTyxDQUFHQyxDQUFkLENBQ0ksTUFBT25DLENBQUFBLENBQVAsQ0FHSixHQUFJa0MsQ0FBTyxDQUFHQyxDQUFkLENBQ0ksTUFBT2hDLENBQUFBLENBRWQsQ0FuRHNCLE1BcURuQndCLENBQUFBLENBQU0sQ0FBR0MsQ0FyRFUsQ0FzRFo1QixDQXREWSxDQXlEaEJHLENBQ1YsQ0FFRCxNQUFPSCxDQUFBQSxDQUNWLENBRUQsR0FBSSxFQUFhOEIsQ0FBYixDQUFKLENBQ0ksTUFBTzNCLENBQUFBLENBQVAsQ0FHSixHQUFJMEIsQ0FBTyxDQUFHQyxDQUFkLENBQ0ksTUFBTzlCLENBQUFBLENBQVAsQ0FHSixHQUFJNkIsQ0FBTyxDQUFHQyxDQUFkLENBQ0ksTUFBTzNCLENBQUFBLENBRWQsQ0FuRkQsTUFxRkl3QixDQUFBQSxDQUFNLENBQUdDLENBckZiLENBc0ZXNUIsQ0F0RlgsQ0F5Rk9HLENBekZQLENBMEZILENBMUlZLE1BNElUcUIsQ0FBQUEsQ0FBTSxDQUFDN0IsTUFBUCxDQUFnQjhCLENBQU0sQ0FBQzlCLE1BNUlkLENBNklGSyxDQTdJRSxDQWdKVHdCLENBQU0sQ0FBQzdCLE1BQVAsQ0FBZ0I4QixDQUFNLENBQUM5QixNQWhKZCxDQWlKRlEsQ0FqSkUsRUFxSmhCLENBQ0osQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfY2hhcmFjdGVyRm9sZCBmcm9tICdpc290cm9waWMtY2hhcmFjdGVyLWZvbGQnO1xuaW1wb3J0IF9FcnJvciBmcm9tICdpc290cm9waWMtZXJyb3InO1xuXG5jb25zdCBfbGV4aWNvZ3JhcGhpY09yZGVyUmVnZXhwID0gL15bKy1dP1xcZCsoPzpcXC5bKy1dP1xcZCspezIsfSQvdSxcbiAgICBfc3BsaXRTdHJpbmcgPSBzdHJpbmcgPT4ge1xuICAgICAgICBjb25zdCBzcGxpdCA9IFtdO1xuXG4gICAgICAgIGxldCBsYXN0SW5kZXggPSAwO1xuXG4gICAgICAgIHN0cmluZy5yZXBsYWNlKC8oWystXT9cXGQrKD86XFwuWystXT9cXGQrKSopL2d1LCAobWF0Y2gsIG51bWJlcnMsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBzcGxpdC5wdXNoKHN0cmluZy5zdWJzdHJpbmcobGFzdEluZGV4LCBpbmRleCkpO1xuICAgICAgICAgICAgc3BsaXQucHVzaChtYXRjaCk7XG4gICAgICAgICAgICBsYXN0SW5kZXggPSBpbmRleCArIG1hdGNoLmxlbmd0aDtcbiAgICAgICAgICAgIHJldHVybiBtYXRjaDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGxhc3RJbmRleCAhPT0gc3RyaW5nLmxlbmd0aCkge1xuICAgICAgICAgICAgc3BsaXQucHVzaChzdHJpbmcuc3Vic3RyaW5nKGxhc3RJbmRleCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNwbGl0O1xuICAgIH07XG5cbmV4cG9ydCBkZWZhdWx0ICh7XG4gICAgY2FzZVNlbnNpdGl2ZSA9IGZhbHNlLFxuICAgIGRpcmVjdGlvbiA9ICdhc2MnLFxuICAgIGlnbm9yZVNwZWNpYWxDaGFyYWN0ZXJzID0gdHJ1ZSxcbiAgICBwcmVmaXhQb3NpdGlvbnMgPSB7fVxufSA9IHt9KSA9PiB7XG4gICAgY29uc3QgYUlzRXF1YWxUb0IgPSAwLFxuICAgICAgICBhSXNHcmVhdGVyVGhhbkIgPSAoKCkgPT4ge1xuICAgICAgICAgICAgc3dpdGNoIChkaXJlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBjYXNlICdhc2MnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgICAgICBjYXNlICdkZXNjJzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aHJvdyBfRXJyb3Ioe1xuICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnSW52YWxpZCBkaXJlY3Rpb24nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSkoKSxcbiAgICAgICAgYUlzTGVzc1RoYW5CID0gLWFJc0dyZWF0ZXJUaGFuQixcbiAgICAgICAgYVBvc2l0aW9uID0gcG9zaXRpb24gPT4ge1xuICAgICAgICAgICAgc3dpdGNoIChwb3NpdGlvbikge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2ZpcnN0JzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFJc0xlc3NUaGFuQjtcbiAgICAgICAgICAgICAgICBjYXNlICdsYXN0JzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFJc0dyZWF0ZXJUaGFuQjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhyb3cgX0Vycm9yKHtcbiAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnSW52YWxpZCBwb3NpdGlvbidcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBiUG9zaXRpb24gPSBwb3NpdGlvbiA9PiB7XG4gICAgICAgICAgICBzd2l0Y2ggKHBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnZmlyc3QnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUlzR3JlYXRlclRoYW5CO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2xhc3QnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUlzTGVzc1RoYW5CO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aHJvdyBfRXJyb3Ioe1xuICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIHBvc2l0aW9uJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIG5vcm1hbGl6ZVN0cmluZyA9ICgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoY2FzZVNlbnNpdGl2ZSkge1xuICAgICAgICAgICAgICAgIGlmIChpZ25vcmVTcGVjaWFsQ2hhcmFjdGVycykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nID0+IF9jaGFyYWN0ZXJGb2xkKHN0cmluZyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZyA9PiBzdHJpbmc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChpZ25vcmVTcGVjaWFsQ2hhcmFjdGVycykge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcgPT4gX2NoYXJhY3RlckZvbGQoc3RyaW5nKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gc3RyaW5nID0+IHN0cmluZy50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9KSgpLFxuICAgICAgICBwcmVmaXhlcyA9IE9iamVjdC5rZXlzKHByZWZpeFBvc2l0aW9ucykuc29ydCgoYSwgYikgPT4gYi5sZW5ndGggLSBhLmxlbmd0aCk7XG5cbiAgICByZXR1cm4gKGEsIGIpID0+IHtcbiAgICAgICAgaWYgKCFhICYmIGEgIT09IDApIHtcbiAgICAgICAgICAgIGlmICghYiAmJiBiICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFJc0VxdWFsVG9CO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gYVBvc2l0aW9uKCdsYXN0Jyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWIgJiYgYiAhPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGJQb3NpdGlvbignbGFzdCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgYSA9IGAke2F9YDtcbiAgICAgICAgYiA9IGAke2J9YDtcblxuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgYVByZWZpeFBvc2l0aW9uLFxuICAgICAgICAgICAgICAgIGJQcmVmaXhQb3NpdGlvbjtcblxuICAgICAgICAgICAgcHJlZml4ZXMuc29tZShwcmVmaXggPT4ge1xuICAgICAgICAgICAgICAgIGlmICghYVByZWZpeFBvc2l0aW9uICYmIGEuc3RhcnRzV2l0aChwcmVmaXgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFQcmVmaXhQb3NpdGlvbiA9IHByZWZpeFBvc2l0aW9uc1twcmVmaXhdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghYlByZWZpeFBvc2l0aW9uICYmIGIuc3RhcnRzV2l0aChwcmVmaXgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGJQcmVmaXhQb3NpdGlvbiA9IHByZWZpeFBvc2l0aW9uc1twcmVmaXhdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBhUHJlZml4UG9zaXRpb24gJiYgYlByZWZpeFBvc2l0aW9uO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChhUHJlZml4UG9zaXRpb24gIT09IGJQcmVmaXhQb3NpdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChhUHJlZml4UG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFQb3NpdGlvbihhUHJlZml4UG9zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBiUG9zaXRpb24oYlByZWZpeFBvc2l0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGFTcGxpdCA9IF9zcGxpdFN0cmluZyhhKSxcbiAgICAgICAgICAgIGJTcGxpdCA9IF9zcGxpdFN0cmluZyhiKTtcblxuICAgICAgICBmb3IgKGxldCBpbmRleCA9IDAsIG1pbmltdW1MZW5ndGggPSBNYXRoLm1pbihhU3BsaXQubGVuZ3RoLCBiU3BsaXQubGVuZ3RoKTsgaW5kZXggPCBtaW5pbXVtTGVuZ3RoOyBpbmRleCArPSAxKSB7XG4gICAgICAgICAgICBjb25zdCBhQ2h1bmsgPSBhU3BsaXRbaW5kZXhdLFxuICAgICAgICAgICAgICAgIGJDaHVuayA9IGJTcGxpdFtpbmRleF07XG5cbiAgICAgICAgICAgIGlmIChhQ2h1bmsgPT09IGJDaHVuaykge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgYU51bWJlciA9ICthQ2h1bmssXG4gICAgICAgICAgICAgICAgICAgIGJOdW1iZXIgPSArYkNodW5rO1xuXG4gICAgICAgICAgICAgICAgaWYgKE51bWJlci5pc05hTihhTnVtYmVyKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoTnVtYmVyLmlzTmFOKGJOdW1iZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2xleGljb2dyYXBoaWNPcmRlclJlZ2V4cC50ZXN0KGFDaHVuaykgJiYgX2xleGljb2dyYXBoaWNPcmRlclJlZ2V4cC50ZXN0KGJDaHVuaykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhTGV4aWNvZ3JhcGhpY09yZGVyID0gYUNodW5rLnNwbGl0KCcuJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJMZXhpY29ncmFwaGljT3JkZXIgPSBiQ2h1bmsuc3BsaXQoJy4nKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGluZGV4ID0gMCwgbWluaW11bUxlbmd0aCA9IE1hdGgubWluKGFMZXhpY29ncmFwaGljT3JkZXIubGVuZ3RoLCBiTGV4aWNvZ3JhcGhpY09yZGVyLmxlbmd0aCk7IGluZGV4IDwgbWluaW11bUxlbmd0aDsgaW5kZXggKz0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhQ2h1bmsgPSBhTGV4aWNvZ3JhcGhpY09yZGVyW2luZGV4XSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJDaHVuayA9IGJMZXhpY29ncmFwaGljT3JkZXJbaW5kZXhdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQ2h1bmsgPT09IGJDaHVuaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhTnVtYmVyID0gK2FDaHVuayxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiTnVtYmVyID0gK2JDaHVuaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFOdW1iZXIgPiBiTnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFJc0dyZWF0ZXJUaGFuQjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFOdW1iZXIgPCBiTnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFJc0xlc3NUaGFuQjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQ2h1bmsgPiBiQ2h1bmspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhSXNHcmVhdGVyVGhhbkI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUlzTGVzc1RoYW5CO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhTGV4aWNvZ3JhcGhpY09yZGVyLmxlbmd0aCA+IGJMZXhpY29ncmFwaGljT3JkZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhSXNHcmVhdGVyVGhhbkI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFJc0xlc3NUaGFuQjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFTdHJpbmcgPSBub3JtYWxpemVTdHJpbmcoYUNodW5rKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYlN0cmluZyA9IG5vcm1hbGl6ZVN0cmluZyhiQ2h1bmspO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFTdHJpbmcgPiBiU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhSXNHcmVhdGVyVGhhbkI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFTdHJpbmcgPCBiU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhSXNMZXNzVGhhbkI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUNodW5rID4gYkNodW5rKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFJc0dyZWF0ZXJUaGFuQjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFJc0xlc3NUaGFuQjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhSXNHcmVhdGVyVGhhbkI7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKE51bWJlci5pc05hTihiTnVtYmVyKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUlzTGVzc1RoYW5CO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChhTnVtYmVyID4gYk51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUlzR3JlYXRlclRoYW5CO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChhTnVtYmVyIDwgYk51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUlzTGVzc1RoYW5CO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGFDaHVuayA+IGJDaHVuaykge1xuICAgICAgICAgICAgICAgIHJldHVybiBhSXNHcmVhdGVyVGhhbkI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBhSXNMZXNzVGhhbkI7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYVNwbGl0Lmxlbmd0aCA+IGJTcGxpdC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBhSXNHcmVhdGVyVGhhbkI7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYVNwbGl0Lmxlbmd0aCA8IGJTcGxpdC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBhSXNMZXNzVGhhbkI7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYUlzRXF1YWxUb0I7XG4gICAgfTtcbn07XG4iXX0=
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Dispatcher",{enumerable:!0,get:function(){return _dispatcher.default}}),Object.defineProperty(exports,"Event",{enumerable:!0,get:function(){return _dispatcher.Event}}),Object.defineProperty(exports,"defaultSymbol",{enumerable:!0,get:function(){return _defaultSymbol2.default}}),Object.defineProperty(exports,"Subscription",{enumerable:!0,get:function(){return _subscription.default}}),exports.default=void 0;var _dispatcher=_interopRequireWildcard(require("./dispatcher.js")),_defaultSymbol2=_interopRequireDefault(require("./default-symbol.js")),_isotropicMake=_interopRequireDefault(require("isotropic-make")),_isotropicPropertyChainer=_interopRequireDefault(require("isotropic-property-chainer")),_subscription=_interopRequireDefault(require("./subscription.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var cache=new WeakMap;return _getRequireWildcardCache=function(){return cache},cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache();if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}const _protectedDefineEventMethod=function({config={},eventName}){return this._events[eventName]="function"==typeof config.newState&&"function"==typeof config.publish&&"function"==typeof config.subscribe?config:(config.Dispatcher||this._Dispatcher)({...config,name:eventName}),this},_publicDefineEventMethod=function(eventName,config){return"string"==typeof eventName?this._defineEvent({config,eventName}):Array.isArray(eventName)?eventName.forEach(eventName=>this._defineEvent({config,eventName})):Reflect.ownKeys(eventName).forEach(key=>this._defineEvent({config:eventName[key],eventName:key})),this},_Pubsub=(0,_isotropicMake.default)([_isotropicPropertyChainer.default],{addDistributor(distributor){return this._distributors||(this._distributors=new Set),Array.isArray(distributor)||distributor instanceof Set?distributor.forEach(distributor=>this._distributors.add(distributor)):this._distributors.add(distributor),this},bulkSubscribe(bulkConfig){Array.isArray(bulkConfig)||(bulkConfig=[bulkConfig]);const subscriptions=bulkConfig.reduce((subscriptions,bulkConfig)=>{if(!("string"==typeof bulkConfig.eventName))Array.isArray(bulkConfig.eventName)?Array.isArray(bulkConfig.config)?bulkConfig.eventName.forEach(eventName=>{bulkConfig.config.forEach(config=>{const subscription=this.subscribe(bulkConfig.stageName,eventName,this._normalizeBulkSubscribeConfig(bulkConfig,config));subscription.subscribed&&subscriptions.push(subscription)})}):bulkConfig.eventName.forEach(eventName=>{const subscription=this.subscribe(bulkConfig.stageName,eventName,this._normalizeBulkSubscribeConfig(bulkConfig));subscription.subscribed&&subscriptions.push(subscription)}):Object.keys(bulkConfig.eventName).forEach(key=>{const config=bulkConfig.eventName[key];if(Array.isArray(config))config.forEach(config=>{const subscription=this.subscribe(bulkConfig.stageName,key,this._normalizeBulkSubscribeConfig(bulkConfig,config));subscription.subscribed&&subscriptions.push(subscription)});else{const subscription=this.subscribe(bulkConfig.stageName,key,this._normalizeBulkSubscribeConfig(bulkConfig,config));subscription.subscribed&&subscriptions.push(subscription)}});else if(Array.isArray(bulkConfig.config))bulkConfig.config.forEach(config=>{const subscription=this.subscribe(bulkConfig.stageName,bulkConfig.eventName,this._normalizeBulkSubscribeConfig(bulkConfig,config));subscription.subscribed&&subscriptions.push(subscription)});else{const subscription=this.subscribe(bulkConfig.stageName,bulkConfig.eventName,this._normalizeBulkSubscribeConfig(bulkConfig));subscription.subscribed&&subscriptions.push(subscription)}return subscriptions},[]);return 1===subscriptions.length?subscriptions[0]:(0,_subscription.default)({get subscribed(){return this.subscriptions.some(subscription=>subscription.subscribed)},subscriptions,unsubscribe(){this.subscriptions.forEach(subscription=>subscription.unsubscribe())}})},bulkUnsubscribe(stageName,eventName){let unsubscribed=!1;if(!("undefined"==typeof eventName))Array.isArray(eventName)||(eventName=[eventName]),Array.isArray(stageName)||(stageName=[stageName]),eventName.forEach(eventName=>{const state=this._eventState[eventName];state&&stageName.forEach(stageName=>{const subscriptions=state.subscriptions[stageName];if(subscriptions)for(const subscription of subscriptions.values())subscription.unsubscribe({publicUnsubscription:!0})&&(unsubscribed=!0)})});else if("undefined"==typeof stageName)for(const state of Object.values(this._eventState))for(const subscriptions of Object.values(state.subscriptions))for(const subscription of subscriptions.values())subscription.unsubscribe({publicUnsubscription:!0})&&(unsubscribed=!0);else Array.isArray(stageName)||(stageName=[stageName]),stageName.forEach(config=>{let eventName,stageName;switch(typeof config){case"string":case"symbol":eventName=config;break;default:eventName=config.eventName,stageName=config.stageName;}const state=this._eventState[eventName];if(state)for(const subscriptions of stageName?[state.subscriptions[stageName]||new Map]:Object.values(state.subscriptions))for(const subscription of subscriptions.values())subscription.unsubscribe({publicUnsubscription:!0})&&(unsubscribed=!0)});return unsubscribed},defineEvent:_publicDefineEventMethod,destroy(...args){return this._publish("destroy",{args})},get destroyed(){return this._destroyed},publish(eventName,data){return this._getEvent(eventName).publish({data,eventName,getDistributionPath:()=>this._getDistributionPath(eventName),lifecycleHost:this,publicPublish:!0,publisher:this,state:this._getEventState(eventName)}),this},removeDistributor(distributor){return this._distributors?(Array.isArray(distributor)||distributor instanceof Set?distributor.forEach(distributor=>this._distributors.delete(distributor)):this._distributors.delete(distributor),this._distributors.size||(this._distributors=null),this):this},subscribe(stageName,eventName,config){return this._getEvent(eventName).subscribe({host:this,...("object"==typeof config?config:{callbackFunction:config}),lifecycleHost:this,publicSubscription:!0,stageName,state:this._getEventState(eventName)})},_bulkSubscribe(bulkConfig){Array.isArray(bulkConfig)||(bulkConfig=[bulkConfig]);const subscriptions=bulkConfig.reduce((subscriptions,bulkConfig)=>{if(!("string"==typeof bulkConfig.eventName))Array.isArray(bulkConfig.eventName)?Array.isArray(bulkConfig.config)?bulkConfig.eventName.forEach(eventName=>{bulkConfig.config.forEach(config=>{const subscription=this._subscribe(bulkConfig.stageName,eventName,this._normalizeBulkSubscribeConfig(bulkConfig,config));subscription.subscribed&&subscriptions.push(subscription)})}):bulkConfig.eventName.forEach(eventName=>{const subscription=this._subscribe(bulkConfig.stageName,eventName,this._normalizeBulkSubscribeConfig(bulkConfig));subscription.subscribed&&subscriptions.push(subscription)}):Object.keys(bulkConfig.eventName).forEach(key=>{const config=bulkConfig.eventName[key];if(Array.isArray(config))config.forEach(config=>{const subscription=this._subscribe(bulkConfig.stageName,key,this._normalizeBulkSubscribeConfig(bulkConfig,config));subscription.subscribed&&subscriptions.push(subscription)});else{const subscription=this._subscribe(bulkConfig.stageName,key,this._normalizeBulkSubscribeConfig(bulkConfig,config));subscription.subscribed&&subscriptions.push(subscription)}});else if(Array.isArray(bulkConfig.config))bulkConfig.config.forEach(config=>{const subscription=this._subscribe(bulkConfig.stageName,bulkConfig.eventName,this._normalizeBulkSubscribeConfig(bulkConfig,config));subscription.subscribed&&subscriptions.push(subscription)});else{const subscription=this._subscribe(bulkConfig.stageName,bulkConfig.eventName,this._normalizeBulkSubscribeConfig(bulkConfig));subscription.subscribed&&subscriptions.push(subscription)}return subscriptions},[]);return 1===subscriptions.length?subscriptions[0]:(0,_subscription.default)({get subscribed(){return this.subscriptions.some(subscription=>subscription.subscribed)},subscriptions,unsubscribe(){this.subscriptions.forEach(subscription=>subscription.unsubscribe())}})},_bulkUnsubscribe(stageName,eventName){let unsubscribed=!1;if(!("undefined"==typeof eventName))Array.isArray(eventName)||(eventName=[eventName]),Array.isArray(stageName)||(stageName=[stageName]),eventName.forEach(eventName=>{const state=this._eventState[eventName];state&&stageName.forEach(stageName=>{const subscriptions=state.subscriptions[stageName];if(subscriptions)for(const subscription of subscriptions.values())subscription.unsubscribe()&&(unsubscribed=!0)})});else if("undefined"==typeof stageName)for(const state of Object.values(this._eventState))for(const subscriptions of Object.values(state.subscriptions))for(const subscription of subscriptions.values())subscription.unsubscribe()&&(unsubscribed=!0);else Array.isArray(stageName)||(stageName=[stageName]),stageName.forEach(config=>{let eventName,stageName;switch(typeof config){case"string":case"symbol":eventName=config;break;default:eventName=config.eventName,stageName=config.stageName;}const state=this._eventState[eventName];if(state)for(const subscriptions of stageName?[state.subscriptions[stageName]||new Map]:Object.values(state.subscriptions))for(const subscription of subscriptions.values())subscription.unsubscribe()&&(unsubscribed=!0)});return unsubscribed},_defineEvent:_protectedDefineEventMethod,_destroy(...args){this._destroyed=!0,this._publish("destroyComplete",{args}),this._bulkUnsubscribe(),this._distributors=void 0,this._events=void 0,this._eventState=void 0},_destroyComplete(){// empty method
},get _Dispatcher(){return this.constructor._Dispatcher},_eventDestroy({data:{args}}){this._destroy(...args)},_eventDestroyComplete({data:{args}}){this._destroyComplete(...args)},_getDistributionPath(eventName){const distributionPath=new Map([[this,this._getEventState(eventName)]]);return distributionPath.forEach((eventState,distributor)=>{distributor._distributors&&distributor._distributors.forEach(distributor=>distributionPath.set(distributor,distributor._getEventState(eventName)))}),distributionPath},_getEvent(eventName){return this._events[eventName]||this._events[_defaultSymbol2.default]},_getEventState(eventName){let eventState=this._eventState[eventName];return eventState||(eventState=this._getEvent(eventName).newState(),this._eventState[eventName]=eventState),eventState},_init(...args){const[{events}={}]=args;return Reflect.apply(_isotropicPropertyChainer.default.prototype._init,this,args),this._destroyed=!1,this._distributors=null,this._events=Object.create(this.constructor._events),this._eventState=Object.create(null),events&&this.defineEvent(events),this},_normalizeBulkSubscribeConfig(bulkSubscribeConfig,config=bulkSubscribeConfig.config){return bulkSubscribeConfig.once?"object"==typeof config?{...config,once:!0}:{callbackFunction:config,once:!0}:config},_publish(eventName,data){return this._getEvent(eventName).publish({data,eventName,getDistributionPath:()=>this._getDistributionPath(eventName),lifecycleHost:this,publisher:this,state:this._getEventState(eventName)}),this},_subscribe(stageName,eventName,config){return this._getEvent(eventName).subscribe({host:this,...("object"==typeof config?config:{callbackFunction:config}),lifecycleHost:this,stageName,state:this._getEventState(eventName)})}},{defineEvent:_publicDefineEventMethod,_addSubscriptionMethods(subscriptionMethods){Array.isArray(subscriptionMethods)||(subscriptionMethods=[subscriptionMethods]),subscriptionMethods.forEach(stageName=>{const onceStageName=`once${stageName.charAt(0).toUpperCase()}${stageName.substr(1)}`,protectedOnceStageName=`_${onceStageName}`,protectedStageName=`_${stageName}`;this.prototype[stageName]||(this.prototype[stageName]=function(eventName,config){return this.bulkSubscribe({config,eventName,stageName})}),this.prototype[onceStageName]||(this.prototype[onceStageName]=function(eventName,config){return this.bulkSubscribe({config,eventName,once:!0,stageName})}),this.prototype[protectedOnceStageName]||(this.prototype[protectedOnceStageName]=function(eventName,config){return this._bulkSubscribe({config,eventName,once:!0,stageName})}),this.prototype[protectedStageName]||(this.prototype[protectedStageName]=function(eventName,config){return this._bulkSubscribe({config,eventName,stageName})})})},_defineEvent:_protectedDefineEventMethod,_Dispatcher:_dispatcher.default,_events:Object.assign(Object.create(null),{destroy:{allowPublicPublish:!1,completeOnce:!0,defaultFunction:"_eventDestroy",Dispatcher:_dispatcher.default},destroyComplete:{allowPublicPublish:!1,defaultFunction:"_eventDestroyComplete",Dispatcher:_dispatcher.default,publishOnce:!0},[_defaultSymbol2.default]:{}}),_init(...args){return Reflect.apply(_isotropicPropertyChainer.default._init,this,args),this.hasOwnProperty("_events")&&this.defineEvent(this._events),this.hasOwnProperty("_subscriptionMethods")&&this._addSubscriptionMethods(this._subscriptionMethods),this},_propertyChains:new Set(["_events"]),_subscriptionMethods:["after","before","on"]});exports.default=_Pubsub;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2pzL3B1YnN1Yi5qcyJdLCJuYW1lcyI6WyJfcHJvdGVjdGVkRGVmaW5lRXZlbnRNZXRob2QiLCJjb25maWciLCJldmVudE5hbWUiLCJfZXZlbnRzIiwibmV3U3RhdGUiLCJwdWJsaXNoIiwic3Vic2NyaWJlIiwiRGlzcGF0Y2hlciIsIl9EaXNwYXRjaGVyIiwibmFtZSIsIl9wdWJsaWNEZWZpbmVFdmVudE1ldGhvZCIsIl9kZWZpbmVFdmVudCIsIkFycmF5IiwiaXNBcnJheSIsImZvckVhY2giLCJSZWZsZWN0Iiwib3duS2V5cyIsImtleSIsIl9QdWJzdWIiLCJfUHJvcGVydHlDaGFpbmVyIiwiYWRkRGlzdHJpYnV0b3IiLCJkaXN0cmlidXRvciIsIl9kaXN0cmlidXRvcnMiLCJTZXQiLCJhZGQiLCJidWxrU3Vic2NyaWJlIiwiYnVsa0NvbmZpZyIsInN1YnNjcmlwdGlvbnMiLCJyZWR1Y2UiLCJzdWJzY3JpcHRpb24iLCJzdGFnZU5hbWUiLCJfbm9ybWFsaXplQnVsa1N1YnNjcmliZUNvbmZpZyIsInN1YnNjcmliZWQiLCJwdXNoIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsInNvbWUiLCJ1bnN1YnNjcmliZSIsImJ1bGtVbnN1YnNjcmliZSIsInVuc3Vic2NyaWJlZCIsInN0YXRlIiwiX2V2ZW50U3RhdGUiLCJ2YWx1ZXMiLCJwdWJsaWNVbnN1YnNjcmlwdGlvbiIsIk1hcCIsImRlZmluZUV2ZW50IiwiZGVzdHJveSIsImFyZ3MiLCJfcHVibGlzaCIsImRlc3Ryb3llZCIsIl9kZXN0cm95ZWQiLCJkYXRhIiwiX2dldEV2ZW50IiwiZ2V0RGlzdHJpYnV0aW9uUGF0aCIsIl9nZXREaXN0cmlidXRpb25QYXRoIiwibGlmZWN5Y2xlSG9zdCIsInB1YmxpY1B1Ymxpc2giLCJwdWJsaXNoZXIiLCJfZ2V0RXZlbnRTdGF0ZSIsInJlbW92ZURpc3RyaWJ1dG9yIiwiZGVsZXRlIiwic2l6ZSIsImhvc3QiLCJjYWxsYmFja0Z1bmN0aW9uIiwicHVibGljU3Vic2NyaXB0aW9uIiwiX2J1bGtTdWJzY3JpYmUiLCJfc3Vic2NyaWJlIiwiX2J1bGtVbnN1YnNjcmliZSIsIl9kZXN0cm95IiwiX2Rlc3Ryb3lDb21wbGV0ZSIsImNvbnN0cnVjdG9yIiwiX2V2ZW50RGVzdHJveSIsIl9ldmVudERlc3Ryb3lDb21wbGV0ZSIsImRpc3RyaWJ1dGlvblBhdGgiLCJldmVudFN0YXRlIiwic2V0IiwiX2RlZmF1bHRTeW1ib2wiLCJfaW5pdCIsImV2ZW50cyIsImFwcGx5IiwicHJvdG90eXBlIiwiY3JlYXRlIiwiYnVsa1N1YnNjcmliZUNvbmZpZyIsIm9uY2UiLCJfYWRkU3Vic2NyaXB0aW9uTWV0aG9kcyIsInN1YnNjcmlwdGlvbk1ldGhvZHMiLCJvbmNlU3RhZ2VOYW1lIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJzdWJzdHIiLCJwcm90ZWN0ZWRPbmNlU3RhZ2VOYW1lIiwicHJvdGVjdGVkU3RhZ2VOYW1lIiwiYXNzaWduIiwiYWxsb3dQdWJsaWNQdWJsaXNoIiwiY29tcGxldGVPbmNlIiwiZGVmYXVsdEZ1bmN0aW9uIiwiZGVzdHJveUNvbXBsZXRlIiwicHVibGlzaE9uY2UiLCJoYXNPd25Qcm9wZXJ0eSIsIl9zdWJzY3JpcHRpb25NZXRob2RzIiwiX3Byb3BlcnR5Q2hhaW5zIl0sIm1hcHBpbmdzIjoicXNEQVFBLEtBQU1BLENBQUFBLDJCQUEyQixDQUFHLFNBQVUsQ0FDdENDLE1BQU0sQ0FBRyxFQUQ2QixDQUV0Q0MsU0FGc0MsQ0FBVixDQUc3QixDQVFDLE1BUEEsTUFBS0MsT0FBTCxDQUFhRCxTQUFiLEVBQXFELFVBQTNCLFFBQU9ELENBQUFBLE1BQU0sQ0FBQ0csUUFBZCxFQUFtRSxVQUExQixRQUFPSCxDQUFBQSxNQUFNLENBQUNJLE9BQXZELEVBQTZHLFVBQTVCLFFBQU9KLENBQUFBLE1BQU0sQ0FBQ0ssU0FBL0YsQ0FDdEJMLE1BRHNCLENBRXRCLENBQUNBLE1BQU0sQ0FBQ00sVUFBUCxFQUFxQixLQUFLQyxXQUEzQixFQUF3QyxDQUNwQyxHQUFHUCxNQURp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QUFFLENBQ0wrQyxrQkFBa0IsR0FEYixDQUVMQyxZQUFZLEdBRlAsQ0FHTEMsZUFBZSxDQUFFLGVBSFosQ0FJTHpGLFVBQVUsQ0FBRUMsbUJBSlAsQ0FEK0IsQ0FPeEN5RixlQUFlLENBQUUsQ0FDYkgsa0JBQWtCLEdBREwsQ0FFYkUsZUFBZSxDQUFFLHVCQUZKLENBR2J6RixVQUFVLENBQUVDLG1CQUhDLENBSWIwRixXQUFXLEdBSkUsQ0FQdUIsQ0FheEMsQ0FBQ3JCLHVCQUFELEVBQWtCLEVBYnNCLENBQW5DLENBM0RWLENBMEVDQyxLQUFLLENBQUUsR0FBRzlCLElBQUwsQ0FBVyxDQVdaLE1BVkFqQyxDQUFBQSxPQUFPLENBQUNpRSxLQUFSLENBQWM3RCxrQ0FBaUIyRCxLQUEvQixDQUFzQyxJQUF0QyxDQUE0QzlCLElBQTVDLENBVUEsQ0FSSSxLQUFLbUQsY0FBTCxDQUFvQixTQUFwQixDQVFKLEVBUEksS0FBS3JELFdBQUwsQ0FBaUIsS0FBSzNDLE9BQXRCLENBT0osQ0FKSSxLQUFLZ0csY0FBTCxDQUFvQixzQkFBcEIsQ0FJSixFQUhJLEtBQUtkLHVCQUFMLENBQTZCLEtBQUtlLG9CQUFsQyxDQUdKLENBQU8sSUFDVixDQXRGRixDQXVGQ0MsZUFBZSxDQUFFLEdBQUk5RSxDQUFBQSxHQUFKLENBQVEsQ0FDckIsU0FEcUIsQ0FBUixDQXZGbEIsQ0EwRkM2RSxvQkFBb0IsQ0FBRSxDQUNsQixPQURrQixDQUVsQixRQUZrQixDQUdsQixJQUhrQixDQTFGdkIsQ0F2aEJPLENBakNkLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX0Rpc3BhdGNoZXIsIHtcbiAgICBFdmVudCBhcyBfRXZlbnRcbn0gZnJvbSAnLi9kaXNwYXRjaGVyLmpzJztcbmltcG9ydCBfZGVmYXVsdFN5bWJvbCBmcm9tICcuL2RlZmF1bHQtc3ltYm9sLmpzJztcbmltcG9ydCBfbWFrZSBmcm9tICdpc290cm9waWMtbWFrZSc7XG5pbXBvcnQgX1Byb3BlcnR5Q2hhaW5lciBmcm9tICdpc290cm9waWMtcHJvcGVydHktY2hhaW5lcic7XG5pbXBvcnQgX1N1YnNjcmlwdGlvbiBmcm9tICcuL3N1YnNjcmlwdGlvbi5qcyc7XG5cbmNvbnN0IF9wcm90ZWN0ZWREZWZpbmVFdmVudE1ldGhvZCA9IGZ1bmN0aW9uICh7XG4gICAgICAgIGNvbmZpZyA9IHt9LFxuICAgICAgICBldmVudE5hbWVcbiAgICB9KSB7XG4gICAgICAgIHRoaXMuX2V2ZW50c1tldmVudE5hbWVdID0gdHlwZW9mIGNvbmZpZy5uZXdTdGF0ZSA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgY29uZmlnLnB1Ymxpc2ggPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGNvbmZpZy5zdWJzY3JpYmUgPT09ICdmdW5jdGlvbicgP1xuICAgICAgICAgICAgY29uZmlnIDpcbiAgICAgICAgICAgIChjb25maWcuRGlzcGF0Y2hlciB8fCB0aGlzLl9EaXNwYXRjaGVyKSh7XG4gICAgICAgICAgICAgICAgLi4uY29uZmlnLFxuICAgICAgICAgICAgICAgIG5hbWU6IGV2ZW50TmFtZVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICBfcHVibGljRGVmaW5lRXZlbnRNZXRob2QgPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBjb25maWcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBldmVudE5hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aGlzLl9kZWZpbmVFdmVudCh7XG4gICAgICAgICAgICAgICAgY29uZmlnLFxuICAgICAgICAgICAgICAgIGV2ZW50TmFtZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShldmVudE5hbWUpKSB7XG4gICAgICAgICAgICBldmVudE5hbWUuZm9yRWFjaChldmVudE5hbWUgPT4gdGhpcy5fZGVmaW5lRXZlbnQoe1xuICAgICAgICAgICAgICAgIGNvbmZpZyxcbiAgICAgICAgICAgICAgICBldmVudE5hbWVcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFJlZmxlY3Qub3duS2V5cyhldmVudE5hbWUpLmZvckVhY2goa2V5ID0+IHRoaXMuX2RlZmluZUV2ZW50KHtcbiAgICAgICAgICAgICAgICBjb25maWc6IGV2ZW50TmFtZVtrZXldLFxuICAgICAgICAgICAgICAgIGV2ZW50TmFtZToga2V5XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICAgIF9QdWJzdWIgPSBfbWFrZShbXG4gICAgICAgIF9Qcm9wZXJ0eUNoYWluZXJcbiAgICBdLCB7XG4gICAgICAgIGFkZERpc3RyaWJ1dG9yIChkaXN0cmlidXRvcikge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9kaXN0cmlidXRvcnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXN0cmlidXRvcnMgPSBuZXcgU2V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGRpc3RyaWJ1dG9yKSB8fCBkaXN0cmlidXRvciBpbnN0YW5jZW9mIFNldCkge1xuICAgICAgICAgICAgICAgIGRpc3RyaWJ1dG9yLmZvckVhY2goZGlzdHJpYnV0b3IgPT4gdGhpcy5fZGlzdHJpYnV0b3JzLmFkZChkaXN0cmlidXRvcikpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXN0cmlidXRvcnMuYWRkKGRpc3RyaWJ1dG9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIGJ1bGtTdWJzY3JpYmUgKGJ1bGtDb25maWcpIHtcbiAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShidWxrQ29uZmlnKSkge1xuICAgICAgICAgICAgICAgIGJ1bGtDb25maWcgPSBbXG4gICAgICAgICAgICAgICAgICAgIGJ1bGtDb25maWdcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb25zID0gYnVsa0NvbmZpZy5yZWR1Y2UoKHN1YnNjcmlwdGlvbnMsIGJ1bGtDb25maWcpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGJ1bGtDb25maWcuZXZlbnROYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShidWxrQ29uZmlnLmNvbmZpZykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1bGtDb25maWcuY29uZmlnLmZvckVhY2goY29uZmlnID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSB0aGlzLnN1YnNjcmliZShidWxrQ29uZmlnLnN0YWdlTmFtZSwgYnVsa0NvbmZpZy5ldmVudE5hbWUsIHRoaXMuX25vcm1hbGl6ZUJ1bGtTdWJzY3JpYmVDb25maWcoYnVsa0NvbmZpZywgY29uZmlnKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLnN1YnNjcmliZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9ucy5wdXNoKHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSB0aGlzLnN1YnNjcmliZShidWxrQ29uZmlnLnN0YWdlTmFtZSwgYnVsa0NvbmZpZy5ldmVudE5hbWUsIHRoaXMuX25vcm1hbGl6ZUJ1bGtTdWJzY3JpYmVDb25maWcoYnVsa0NvbmZpZykpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLnN1YnNjcmliZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25zLnB1c2goc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShidWxrQ29uZmlnLmV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYnVsa0NvbmZpZy5jb25maWcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBidWxrQ29uZmlnLmV2ZW50TmFtZS5mb3JFYWNoKGV2ZW50TmFtZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVsa0NvbmZpZy5jb25maWcuZm9yRWFjaChjb25maWcgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSB0aGlzLnN1YnNjcmliZShidWxrQ29uZmlnLnN0YWdlTmFtZSwgZXZlbnROYW1lLCB0aGlzLl9ub3JtYWxpemVCdWxrU3Vic2NyaWJlQ29uZmlnKGJ1bGtDb25maWcsIGNvbmZpZykpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24uc3Vic2NyaWJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9ucy5wdXNoKHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnVsa0NvbmZpZy5ldmVudE5hbWUuZm9yRWFjaChldmVudE5hbWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHRoaXMuc3Vic2NyaWJlKGJ1bGtDb25maWcuc3RhZ2VOYW1lLCBldmVudE5hbWUsIHRoaXMuX25vcm1hbGl6ZUJ1bGtTdWJzY3JpYmVDb25maWcoYnVsa0NvbmZpZykpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi5zdWJzY3JpYmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMucHVzaChzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoYnVsa0NvbmZpZy5ldmVudE5hbWUpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IGJ1bGtDb25maWcuZXZlbnROYW1lW2tleV07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvbmZpZykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maWcuZm9yRWFjaChjb25maWcgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSB0aGlzLnN1YnNjcmliZShidWxrQ29uZmlnLnN0YWdlTmFtZSwga2V5LCB0aGlzLl9ub3JtYWxpemVCdWxrU3Vic2NyaWJlQ29uZmlnKGJ1bGtDb25maWcsIGNvbmZpZykpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24uc3Vic2NyaWJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9ucy5wdXNoKHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gdGhpcy5zdWJzY3JpYmUoYnVsa0NvbmZpZy5zdGFnZU5hbWUsIGtleSwgdGhpcy5fbm9ybWFsaXplQnVsa1N1YnNjcmliZUNvbmZpZyhidWxrQ29uZmlnLCBjb25maWcpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24uc3Vic2NyaWJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25zLnB1c2goc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb25zO1xuICAgICAgICAgICAgfSwgW10pO1xuXG4gICAgICAgICAgICByZXR1cm4gc3Vic2NyaXB0aW9ucy5sZW5ndGggPT09IDEgP1xuICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnNbMF0gOlxuICAgICAgICAgICAgICAgIF9TdWJzY3JpcHRpb24oe1xuICAgICAgICAgICAgICAgICAgICBnZXQgc3Vic2NyaWJlZCAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdWJzY3JpcHRpb25zLnNvbWUoc3Vic2NyaXB0aW9uID0+IHN1YnNjcmlwdGlvbi5zdWJzY3JpYmVkKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgdW5zdWJzY3JpYmUgKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLmZvckVhY2goc3Vic2NyaXB0aW9uID0+IHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBidWxrVW5zdWJzY3JpYmUgKHN0YWdlTmFtZSwgZXZlbnROYW1lKSB7XG4gICAgICAgICAgICBsZXQgdW5zdWJzY3JpYmVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgZXZlbnROYW1lID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc3RhZ2VOYW1lID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHN0YXRlIG9mIE9iamVjdC52YWx1ZXModGhpcy5fZXZlbnRTdGF0ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgc3Vic2NyaXB0aW9ucyBvZiBPYmplY3QudmFsdWVzKHN0YXRlLnN1YnNjcmlwdGlvbnMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBzdWJzY3JpcHRpb24gb2Ygc3Vic2NyaXB0aW9ucy52YWx1ZXMoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1YmxpY1Vuc3Vic2NyaXB0aW9uOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnN1YnNjcmliZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHN0YWdlTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWdlTmFtZSA9IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFnZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBzdGFnZU5hbWUuZm9yRWFjaChjb25maWcgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGV2ZW50TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFnZU5hbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodHlwZW9mIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3ltYm9sJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnROYW1lID0gY29uZmlnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudE5hbWUgPSBjb25maWcuZXZlbnROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFnZU5hbWUgPSBjb25maWcuc3RhZ2VOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGF0ZSA9IHRoaXMuX2V2ZW50U3RhdGVbZXZlbnROYW1lXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBzdWJzY3JpcHRpb25zIG9mIHN0YWdlTmFtZSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLnN1YnNjcmlwdGlvbnNbc3RhZ2VOYW1lXSB8fCBuZXcgTWFwKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC52YWx1ZXMoc3RhdGUuc3Vic2NyaXB0aW9ucykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBzdWJzY3JpcHRpb24gb2Ygc3Vic2NyaXB0aW9ucy52YWx1ZXMoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVibGljVW5zdWJzY3JpcHRpb246IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zdWJzY3JpYmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZXZlbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBldmVudE5hbWUgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudE5hbWVcbiAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoc3RhZ2VOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBzdGFnZU5hbWUgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFnZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBldmVudE5hbWUuZm9yRWFjaChldmVudE5hbWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGF0ZSA9IHRoaXMuX2V2ZW50U3RhdGVbZXZlbnROYW1lXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWdlTmFtZS5mb3JFYWNoKHN0YWdlTmFtZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9ucyA9IHN0YXRlLnN1YnNjcmlwdGlvbnNbc3RhZ2VOYW1lXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgc3Vic2NyaXB0aW9uIG9mIHN1YnNjcmlwdGlvbnMudmFsdWVzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1YmxpY1Vuc3Vic2NyaXB0aW9uOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc3Vic2NyaWJlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdW5zdWJzY3JpYmVkO1xuICAgICAgICB9LFxuICAgICAgICBkZWZpbmVFdmVudDogX3B1YmxpY0RlZmluZUV2ZW50TWV0aG9kLFxuICAgICAgICBkZXN0cm95ICguLi5hcmdzKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcHVibGlzaCgnZGVzdHJveScsIHtcbiAgICAgICAgICAgICAgICBhcmdzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0IGRlc3Ryb3llZCAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZGVzdHJveWVkO1xuICAgICAgICB9LFxuICAgICAgICBwdWJsaXNoIChldmVudE5hbWUsIGRhdGEpIHtcbiAgICAgICAgICAgIHRoaXMuX2dldEV2ZW50KGV2ZW50TmFtZSkucHVibGlzaCh7XG4gICAgICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgICAgICAgICBldmVudE5hbWUsXG4gICAgICAgICAgICAgICAgZ2V0RGlzdHJpYnV0aW9uUGF0aDogKCkgPT4gdGhpcy5fZ2V0RGlzdHJpYnV0aW9uUGF0aChldmVudE5hbWUpLFxuICAgICAgICAgICAgICAgIGxpZmVjeWNsZUhvc3Q6IHRoaXMsXG4gICAgICAgICAgICAgICAgcHVibGljUHVibGlzaDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwdWJsaXNoZXI6IHRoaXMsXG4gICAgICAgICAgICAgICAgc3RhdGU6IHRoaXMuX2dldEV2ZW50U3RhdGUoZXZlbnROYW1lKVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICByZW1vdmVEaXN0cmlidXRvciAoZGlzdHJpYnV0b3IpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fZGlzdHJpYnV0b3JzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGRpc3RyaWJ1dG9yKSB8fCBkaXN0cmlidXRvciBpbnN0YW5jZW9mIFNldCkge1xuICAgICAgICAgICAgICAgIGRpc3RyaWJ1dG9yLmZvckVhY2goZGlzdHJpYnV0b3IgPT4gdGhpcy5fZGlzdHJpYnV0b3JzLmRlbGV0ZShkaXN0cmlidXRvcikpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXN0cmlidXRvcnMuZGVsZXRlKGRpc3RyaWJ1dG9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCF0aGlzLl9kaXN0cmlidXRvcnMuc2l6ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Rpc3RyaWJ1dG9ycyA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICBzdWJzY3JpYmUgKHN0YWdlTmFtZSwgZXZlbnROYW1lLCBjb25maWcpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRFdmVudChldmVudE5hbWUpLnN1YnNjcmliZSh7XG4gICAgICAgICAgICAgICAgaG9zdDogdGhpcyxcbiAgICAgICAgICAgICAgICAuLi50eXBlb2YgY29uZmlnID09PSAnb2JqZWN0JyA/XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZyA6XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrRnVuY3Rpb246IGNvbmZpZ1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGxpZmVjeWNsZUhvc3Q6IHRoaXMsXG4gICAgICAgICAgICAgICAgcHVibGljU3Vic2NyaXB0aW9uOiB0cnVlLFxuICAgICAgICAgICAgICAgIHN0YWdlTmFtZSxcbiAgICAgICAgICAgICAgICBzdGF0ZTogdGhpcy5fZ2V0RXZlbnRTdGF0ZShldmVudE5hbWUpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgX2J1bGtTdWJzY3JpYmUgKGJ1bGtDb25maWcpIHtcbiAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShidWxrQ29uZmlnKSkge1xuICAgICAgICAgICAgICAgIGJ1bGtDb25maWcgPSBbXG4gICAgICAgICAgICAgICAgICAgIGJ1bGtDb25maWdcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb25zID0gYnVsa0NvbmZpZy5yZWR1Y2UoKHN1YnNjcmlwdGlvbnMsIGJ1bGtDb25maWcpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGJ1bGtDb25maWcuZXZlbnROYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShidWxrQ29uZmlnLmNvbmZpZykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1bGtDb25maWcuY29uZmlnLmZvckVhY2goY29uZmlnID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSB0aGlzLl9zdWJzY3JpYmUoYnVsa0NvbmZpZy5zdGFnZU5hbWUsIGJ1bGtDb25maWcuZXZlbnROYW1lLCB0aGlzLl9ub3JtYWxpemVCdWxrU3Vic2NyaWJlQ29uZmlnKGJ1bGtDb25maWcsIGNvbmZpZykpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi5zdWJzY3JpYmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMucHVzaChzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gdGhpcy5fc3Vic2NyaWJlKGJ1bGtDb25maWcuc3RhZ2VOYW1lLCBidWxrQ29uZmlnLmV2ZW50TmFtZSwgdGhpcy5fbm9ybWFsaXplQnVsa1N1YnNjcmliZUNvbmZpZyhidWxrQ29uZmlnKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24uc3Vic2NyaWJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMucHVzaChzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGJ1bGtDb25maWcuZXZlbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShidWxrQ29uZmlnLmNvbmZpZykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1bGtDb25maWcuZXZlbnROYW1lLmZvckVhY2goZXZlbnROYW1lID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWxrQ29uZmlnLmNvbmZpZy5mb3JFYWNoKGNvbmZpZyA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHRoaXMuX3N1YnNjcmliZShidWxrQ29uZmlnLnN0YWdlTmFtZSwgZXZlbnROYW1lLCB0aGlzLl9ub3JtYWxpemVCdWxrU3Vic2NyaWJlQ29uZmlnKGJ1bGtDb25maWcsIGNvbmZpZykpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24uc3Vic2NyaWJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9ucy5wdXNoKHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnVsa0NvbmZpZy5ldmVudE5hbWUuZm9yRWFjaChldmVudE5hbWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHRoaXMuX3N1YnNjcmliZShidWxrQ29uZmlnLnN0YWdlTmFtZSwgZXZlbnROYW1lLCB0aGlzLl9ub3JtYWxpemVCdWxrU3Vic2NyaWJlQ29uZmlnKGJ1bGtDb25maWcpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24uc3Vic2NyaWJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25zLnB1c2goc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGJ1bGtDb25maWcuZXZlbnROYW1lKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25maWcgPSBidWxrQ29uZmlnLmV2ZW50TmFtZVtrZXldO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjb25maWcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLmZvckVhY2goY29uZmlnID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gdGhpcy5fc3Vic2NyaWJlKGJ1bGtDb25maWcuc3RhZ2VOYW1lLCBrZXksIHRoaXMuX25vcm1hbGl6ZUJ1bGtTdWJzY3JpYmVDb25maWcoYnVsa0NvbmZpZywgY29uZmlnKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi5zdWJzY3JpYmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25zLnB1c2goc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSB0aGlzLl9zdWJzY3JpYmUoYnVsa0NvbmZpZy5zdGFnZU5hbWUsIGtleSwgdGhpcy5fbm9ybWFsaXplQnVsa1N1YnNjcmliZUNvbmZpZyhidWxrQ29uZmlnLCBjb25maWcpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24uc3Vic2NyaWJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25zLnB1c2goc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb25zO1xuICAgICAgICAgICAgfSwgW10pO1xuXG4gICAgICAgICAgICByZXR1cm4gc3Vic2NyaXB0aW9ucy5sZW5ndGggPT09IDEgP1xuICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnNbMF0gOlxuICAgICAgICAgICAgICAgIF9TdWJzY3JpcHRpb24oe1xuICAgICAgICAgICAgICAgICAgICBnZXQgc3Vic2NyaWJlZCAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdWJzY3JpcHRpb25zLnNvbWUoc3Vic2NyaXB0aW9uID0+IHN1YnNjcmlwdGlvbi5zdWJzY3JpYmVkKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgdW5zdWJzY3JpYmUgKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLmZvckVhY2goc3Vic2NyaXB0aW9uID0+IHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBfYnVsa1Vuc3Vic2NyaWJlIChzdGFnZU5hbWUsIGV2ZW50TmFtZSkge1xuICAgICAgICAgICAgbGV0IHVuc3Vic2NyaWJlZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGV2ZW50TmFtZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHN0YWdlTmFtZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBzdGF0ZSBvZiBPYmplY3QudmFsdWVzKHRoaXMuX2V2ZW50U3RhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHN1YnNjcmlwdGlvbnMgb2YgT2JqZWN0LnZhbHVlcyhzdGF0ZS5zdWJzY3JpcHRpb25zKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgc3Vic2NyaXB0aW9uIG9mIHN1YnNjcmlwdGlvbnMudmFsdWVzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnN1YnNjcmliZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHN0YWdlTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWdlTmFtZSA9IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFnZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBzdGFnZU5hbWUuZm9yRWFjaChjb25maWcgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGV2ZW50TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFnZU5hbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodHlwZW9mIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3ltYm9sJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnROYW1lID0gY29uZmlnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudE5hbWUgPSBjb25maWcuZXZlbnROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFnZU5hbWUgPSBjb25maWcuc3RhZ2VOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGF0ZSA9IHRoaXMuX2V2ZW50U3RhdGVbZXZlbnROYW1lXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBzdWJzY3JpcHRpb25zIG9mIHN0YWdlTmFtZSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLnN1YnNjcmlwdGlvbnNbc3RhZ2VOYW1lXSB8fCBuZXcgTWFwKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC52YWx1ZXMoc3RhdGUuc3Vic2NyaXB0aW9ucykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBzdWJzY3JpcHRpb24gb2Ygc3Vic2NyaXB0aW9ucy52YWx1ZXMoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zdWJzY3JpYmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZXZlbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBldmVudE5hbWUgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudE5hbWVcbiAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoc3RhZ2VOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBzdGFnZU5hbWUgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFnZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBldmVudE5hbWUuZm9yRWFjaChldmVudE5hbWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGF0ZSA9IHRoaXMuX2V2ZW50U3RhdGVbZXZlbnROYW1lXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWdlTmFtZS5mb3JFYWNoKHN0YWdlTmFtZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9ucyA9IHN0YXRlLnN1YnNjcmlwdGlvbnNbc3RhZ2VOYW1lXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgc3Vic2NyaXB0aW9uIG9mIHN1YnNjcmlwdGlvbnMudmFsdWVzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc3Vic2NyaWJlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdW5zdWJzY3JpYmVkO1xuICAgICAgICB9LFxuICAgICAgICBfZGVmaW5lRXZlbnQ6IF9wcm90ZWN0ZWREZWZpbmVFdmVudE1ldGhvZCxcbiAgICAgICAgX2Rlc3Ryb3kgKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgIHRoaXMuX2Rlc3Ryb3llZCA9IHRydWU7XG5cbiAgICAgICAgICAgIHRoaXMuX3B1Ymxpc2goJ2Rlc3Ryb3lDb21wbGV0ZScsIHtcbiAgICAgICAgICAgICAgICBhcmdzXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5fYnVsa1Vuc3Vic2NyaWJlKCk7XG5cbiAgICAgICAgICAgIHRoaXMuX2Rpc3RyaWJ1dG9ycyA9IHZvaWQgbnVsbDtcblxuICAgICAgICAgICAgdGhpcy5fZXZlbnRzID0gdm9pZCBudWxsO1xuXG4gICAgICAgICAgICB0aGlzLl9ldmVudFN0YXRlID0gdm9pZCBudWxsO1xuICAgICAgICB9LFxuICAgICAgICBfZGVzdHJveUNvbXBsZXRlICgpIHtcbiAgICAgICAgICAgIC8vIGVtcHR5IG1ldGhvZFxuICAgICAgICB9LFxuICAgICAgICBnZXQgX0Rpc3BhdGNoZXIgKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3IuX0Rpc3BhdGNoZXI7XG4gICAgICAgIH0sXG4gICAgICAgIF9ldmVudERlc3Ryb3kgKHtcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICBhcmdzXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pIHtcbiAgICAgICAgICAgIHRoaXMuX2Rlc3Ryb3koLi4uYXJncyk7XG4gICAgICAgIH0sXG4gICAgICAgIF9ldmVudERlc3Ryb3lDb21wbGV0ZSAoe1xuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIGFyZ3NcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkge1xuICAgICAgICAgICAgdGhpcy5fZGVzdHJveUNvbXBsZXRlKC4uLmFyZ3MpO1xuICAgICAgICB9LFxuICAgICAgICBfZ2V0RGlzdHJpYnV0aW9uUGF0aCAoZXZlbnROYW1lKSB7XG4gICAgICAgICAgICBjb25zdCBkaXN0cmlidXRpb25QYXRoID0gbmV3IE1hcChbW1xuICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgdGhpcy5fZ2V0RXZlbnRTdGF0ZShldmVudE5hbWUpXG4gICAgICAgICAgICBdXSk7XG5cbiAgICAgICAgICAgIGRpc3RyaWJ1dGlvblBhdGguZm9yRWFjaCgoZXZlbnRTdGF0ZSwgZGlzdHJpYnV0b3IpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZGlzdHJpYnV0b3IuX2Rpc3RyaWJ1dG9ycykge1xuICAgICAgICAgICAgICAgICAgICBkaXN0cmlidXRvci5fZGlzdHJpYnV0b3JzLmZvckVhY2goZGlzdHJpYnV0b3IgPT4gZGlzdHJpYnV0aW9uUGF0aC5zZXQoZGlzdHJpYnV0b3IsIGRpc3RyaWJ1dG9yLl9nZXRFdmVudFN0YXRlKGV2ZW50TmFtZSkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRpc3RyaWJ1dGlvblBhdGg7XG4gICAgICAgIH0sXG4gICAgICAgIF9nZXRFdmVudCAoZXZlbnROYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZXZlbnRzW2V2ZW50TmFtZV0gfHwgdGhpcy5fZXZlbnRzW19kZWZhdWx0U3ltYm9sXTtcbiAgICAgICAgfSxcbiAgICAgICAgX2dldEV2ZW50U3RhdGUgKGV2ZW50TmFtZSkge1xuICAgICAgICAgICAgbGV0IGV2ZW50U3RhdGUgPSB0aGlzLl9ldmVudFN0YXRlW2V2ZW50TmFtZV07XG5cbiAgICAgICAgICAgIGlmICghZXZlbnRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIGV2ZW50U3RhdGUgPSB0aGlzLl9nZXRFdmVudChldmVudE5hbWUpLm5ld1N0YXRlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZXZlbnRTdGF0ZVtldmVudE5hbWVdID0gZXZlbnRTdGF0ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGV2ZW50U3RhdGU7XG4gICAgICAgIH0sXG4gICAgICAgIF9pbml0ICguLi5hcmdzKSB7XG4gICAgICAgICAgICBjb25zdCBbe1xuICAgICAgICAgICAgICAgIGV2ZW50c1xuICAgICAgICAgICAgfSA9IHt9XSA9IGFyZ3M7XG5cbiAgICAgICAgICAgIFJlZmxlY3QuYXBwbHkoX1Byb3BlcnR5Q2hhaW5lci5wcm90b3R5cGUuX2luaXQsIHRoaXMsIGFyZ3MpO1xuXG4gICAgICAgICAgICB0aGlzLl9kZXN0cm95ZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgdGhpcy5fZGlzdHJpYnV0b3JzID0gbnVsbDtcblxuICAgICAgICAgICAgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZSh0aGlzLmNvbnN0cnVjdG9yLl9ldmVudHMpO1xuXG4gICAgICAgICAgICB0aGlzLl9ldmVudFN0YXRlID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcblxuICAgICAgICAgICAgaWYgKGV2ZW50cykge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVmaW5lRXZlbnQoZXZlbnRzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIF9ub3JtYWxpemVCdWxrU3Vic2NyaWJlQ29uZmlnIChidWxrU3Vic2NyaWJlQ29uZmlnLCBjb25maWcgPSBidWxrU3Vic2NyaWJlQ29uZmlnLmNvbmZpZykge1xuICAgICAgICAgICAgaWYgKGJ1bGtTdWJzY3JpYmVDb25maWcub25jZSkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY29uZmlnID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uY29uZmlnLFxuICAgICAgICAgICAgICAgICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrRnVuY3Rpb246IGNvbmZpZyxcbiAgICAgICAgICAgICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICAgIH0sXG4gICAgICAgIF9wdWJsaXNoIChldmVudE5hbWUsIGRhdGEpIHtcbiAgICAgICAgICAgIHRoaXMuX2dldEV2ZW50KGV2ZW50TmFtZSkucHVibGlzaCh7XG4gICAgICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgICAgICAgICBldmVudE5hbWUsXG4gICAgICAgICAgICAgICAgZ2V0RGlzdHJpYnV0aW9uUGF0aDogKCkgPT4gdGhpcy5fZ2V0RGlzdHJpYnV0aW9uUGF0aChldmVudE5hbWUpLFxuICAgICAgICAgICAgICAgIGxpZmVjeWNsZUhvc3Q6IHRoaXMsXG4gICAgICAgICAgICAgICAgcHVibGlzaGVyOiB0aGlzLFxuICAgICAgICAgICAgICAgIHN0YXRlOiB0aGlzLl9nZXRFdmVudFN0YXRlKGV2ZW50TmFtZSlcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgX3N1YnNjcmliZSAoc3RhZ2VOYW1lLCBldmVudE5hbWUsIGNvbmZpZykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldEV2ZW50KGV2ZW50TmFtZSkuc3Vic2NyaWJlKHtcbiAgICAgICAgICAgICAgICBob3N0OiB0aGlzLFxuICAgICAgICAgICAgICAgIC4uLnR5cGVvZiBjb25maWcgPT09ICdvYmplY3QnID9cbiAgICAgICAgICAgICAgICAgICAgY29uZmlnIDpcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2tGdW5jdGlvbjogY29uZmlnXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbGlmZWN5Y2xlSG9zdDogdGhpcyxcbiAgICAgICAgICAgICAgICBzdGFnZU5hbWUsXG4gICAgICAgICAgICAgICAgc3RhdGU6IHRoaXMuX2dldEV2ZW50U3RhdGUoZXZlbnROYW1lKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGRlZmluZUV2ZW50OiBfcHVibGljRGVmaW5lRXZlbnRNZXRob2QsXG4gICAgICAgIF9hZGRTdWJzY3JpcHRpb25NZXRob2RzIChzdWJzY3JpcHRpb25NZXRob2RzKSB7XG4gICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoc3Vic2NyaXB0aW9uTWV0aG9kcykpIHtcbiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25NZXRob2RzID0gW1xuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25NZXRob2RzXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc3Vic2NyaXB0aW9uTWV0aG9kcy5mb3JFYWNoKHN0YWdlTmFtZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb25jZVN0YWdlTmFtZSA9IGBvbmNlJHtzdGFnZU5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCl9JHtzdGFnZU5hbWUuc3Vic3RyKDEpfWAsXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZE9uY2VTdGFnZU5hbWUgPSBgXyR7b25jZVN0YWdlTmFtZX1gLFxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWRTdGFnZU5hbWUgPSBgXyR7c3RhZ2VOYW1lfWA7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucHJvdG90eXBlW3N0YWdlTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm90b3R5cGVbc3RhZ2VOYW1lXSA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVsa1N1YnNjcmliZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFnZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5wcm90b3R5cGVbb25jZVN0YWdlTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm90b3R5cGVbb25jZVN0YWdlTmFtZV0gPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1bGtTdWJzY3JpYmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25jZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFnZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5wcm90b3R5cGVbcHJvdGVjdGVkT25jZVN0YWdlTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm90b3R5cGVbcHJvdGVjdGVkT25jZVN0YWdlTmFtZV0gPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9idWxrU3Vic2NyaWJlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maWcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uY2U6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhZ2VOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucHJvdG90eXBlW3Byb3RlY3RlZFN0YWdlTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm90b3R5cGVbcHJvdGVjdGVkU3RhZ2VOYW1lXSA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2J1bGtTdWJzY3JpYmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhZ2VOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgX2RlZmluZUV2ZW50OiBfcHJvdGVjdGVkRGVmaW5lRXZlbnRNZXRob2QsXG4gICAgICAgIF9EaXNwYXRjaGVyLFxuICAgICAgICBfZXZlbnRzOiBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUobnVsbCksIHtcbiAgICAgICAgICAgIGRlc3Ryb3k6IHtcbiAgICAgICAgICAgICAgICBhbGxvd1B1YmxpY1B1Ymxpc2g6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNvbXBsZXRlT25jZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBkZWZhdWx0RnVuY3Rpb246ICdfZXZlbnREZXN0cm95JyxcbiAgICAgICAgICAgICAgICBEaXNwYXRjaGVyOiBfRGlzcGF0Y2hlclxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRlc3Ryb3lDb21wbGV0ZToge1xuICAgICAgICAgICAgICAgIGFsbG93UHVibGljUHVibGlzaDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGVmYXVsdEZ1bmN0aW9uOiAnX2V2ZW50RGVzdHJveUNvbXBsZXRlJyxcbiAgICAgICAgICAgICAgICBEaXNwYXRjaGVyOiBfRGlzcGF0Y2hlcixcbiAgICAgICAgICAgICAgICBwdWJsaXNoT25jZTogdHJ1ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFtfZGVmYXVsdFN5bWJvbF06IHt9XG4gICAgICAgIH0pLFxuICAgICAgICBfaW5pdCAoLi4uYXJncykge1xuICAgICAgICAgICAgUmVmbGVjdC5hcHBseShfUHJvcGVydHlDaGFpbmVyLl9pbml0LCB0aGlzLCBhcmdzKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuaGFzT3duUHJvcGVydHkoJ19ldmVudHMnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVmaW5lRXZlbnQodGhpcy5fZXZlbnRzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuaGFzT3duUHJvcGVydHkoJ19zdWJzY3JpcHRpb25NZXRob2RzJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRTdWJzY3JpcHRpb25NZXRob2RzKHRoaXMuX3N1YnNjcmlwdGlvbk1ldGhvZHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgX3Byb3BlcnR5Q2hhaW5zOiBuZXcgU2V0KFtcbiAgICAgICAgICAgICdfZXZlbnRzJ1xuICAgICAgICBdKSxcbiAgICAgICAgX3N1YnNjcmlwdGlvbk1ldGhvZHM6IFtcbiAgICAgICAgICAgICdhZnRlcicsXG4gICAgICAgICAgICAnYmVmb3JlJyxcbiAgICAgICAgICAgICdvbidcbiAgICAgICAgXVxuICAgIH0pO1xuXG5leHBvcnQge1xuICAgIF9QdWJzdWIgYXMgZGVmYXVsdCxcbiAgICBfZGVmYXVsdFN5bWJvbCBhcyBkZWZhdWx0U3ltYm9sLFxuICAgIF9EaXNwYXRjaGVyIGFzIERpc3BhdGNoZXIsXG4gICAgX0V2ZW50IGFzIEV2ZW50LFxuICAgIF9TdWJzY3JpcHRpb24gYXMgU3Vic2NyaXB0aW9uXG59O1xuIl19